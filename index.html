<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LP SHOP</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .tab-active { border-color: #3b82f6; color: #3b82f6; font-weight: 600; }
        .modal-backdrop { background-color: rgba(0, 0, 0, 0.6); }
        .modal-content { transition: all 0.3s ease-out; }
    </style>
</head>
<body class="bg-gray-100 font-sans">

    <!-- NEW: Audio Player Element (hidden) -->
    <audio id="background-music" loop>
        <source src="https://cdn.pixabay.com/download/audio/2022/11/23/audio_752fa94121.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <!-- Navigation Bar -->
    <nav class="bg-white shadow-md sticky top-0 z-40">
        <!-- ... nav code is the same ... -->
    </nav>

    <main class="container mx-auto p-4 mt-8 min-h-screen">
        <!-- ... all main content is the same ... -->
    </main>

    <div id="modal" class="fixed inset-0 z-50 flex items-center justify-center hidden modal-backdrop">
        <!-- ... modal code is the same ... -->
    </div>

    <!-- NEW: Music Toggle Button -->
    <button id="music-toggle-btn" class="fixed bottom-6 left-6 bg-blue-500 text-white p-4 rounded-full shadow-lg hover:bg-blue-600 transition-transform hover:scale-110">
        <!-- Play Icon (Visible by default) -->
        <svg id="play-icon" xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd" /></svg>
        <!-- Mute Icon (Hidden by default) -->
        <svg id="mute-icon" xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 hidden" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM14.657 2.929a1 1 0 011.414 0L19 5.858a1 1 0 11-1.414 1.414L16 5.414l-1.929 1.929a1 1 0 01-1.414-1.414l1.929-1.93zM16 9.414l1.929-1.929a1 1 0 011.414 1.414L17.414 10.83l1.929 1.929a1 1 0 01-1.414 1.414L16 12.242l-1.929 1.929a1 1 0 01-1.414-1.414L14.586 10.83l-1.929-1.929a1 1 0 011.414-1.414L16 9.414z" clip-rule="evenodd" /></svg>
    </button>

    <a href="https://wa.me/16042397558" target="_blank" class="fixed bottom-6 right-6 bg-green-500 text-white p-4 rounded-full shadow-lg hover:bg-green-600 transition-transform hover:scale-110">
        <!-- ... WhatsApp icon SVG ... -->
    </a>

    <footer class="bg-white mt-16 py-6 border-t"><div class="container mx-auto text-center text-gray-600"><p>&copy; 2024 LP SHOP. All rights reserved.</p></div></footer>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js';
        // ... all other firebase imports are the same
        import { getAuth, onAuthStateChanged, signOut, createUserWithEmailAndPassword, signInWithEmailAndPassword, sendPasswordResetEmail } from 'https://www.gstatic.com/firebasejs/10.14.1/firebase-auth.js';
        import { getFirestore, collection, getDocs, query, orderBy, where, addDoc, serverTimestamp, onSnapshot } from 'https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore.js';

        // ... firebase config and init are the same
        const firebaseConfig = { apiKey: 'AIzaSyA2Y1NmbEdDYRNCooSmf6rcdBdeWg3D9Hg', authDomain: 'lpshop-c8fe6.firebaseapp.com', projectId: 'lpshop-c8fe6', storageBucket: 'lpshop-c8fe6.firebasestorage.app', messagingSenderId: '307849631006', appId: '1:307849631006:web:460e06f55a689b19eda50f' };
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // --- All UI Elements ---
        const UI = {
            // ... all previous UI elements are the same
            // NEW Music Player Elements
            musicPlayer: document.getElementById('background-music'),
            musicToggleButton: document.getElementById('music-toggle-btn'),
            playIcon: document.getElementById('play-icon'),
            muteIcon: document.getElementById('mute-icon')
        };
        
        let productsData = [];
        let unsubscribeOrders = null;

        // --- All other functions (showModal, updateNav, handleBuyNow, etc.) are the same ---
        
        // --- NEW: Music Toggle Logic ---
        const toggleMusic = () => {
            if (UI.musicPlayer.paused) {
                UI.musicPlayer.play().catch(error => console.log("User needs to interact with the page to play music."));
                UI.playIcon.classList.add('hidden');
                UI.muteIcon.classList.remove('hidden');
            } else {
                UI.musicPlayer.pause();
                UI.muteIcon.classList.add('hidden');
                UI.playIcon.classList.remove('hidden');
            }
        };

        // --- Add Event Listener for the Music Button ---
        UI.musicToggleButton.addEventListener('click', toggleMusic);


        // --- ALL OTHER SCRIPT LOGIC IS THE SAME ---
        // (onAuthStateChanged, handleBuyNow, fetchProducts, fetchUserOrders, etc.)
        // For brevity, I am not repeating the entire 100+ lines of identical JS.
        // The only new parts are the music player elements and the toggle function above.
        // Just ensure you add the new elements to the `UI` object and the new function and listener.
        const showModal = (title, body, buttons = []) => {
            UI.modalTitle.textContent = title; UI.modalBody.innerHTML = body; UI.modalFooter.innerHTML = '';
            if (buttons.length === 0) buttons.push({ text: 'Close', class: 'bg-gray-500', action: hideModal });
            buttons.forEach(btn => {
                const el = document.createElement('button');
                el.textContent = btn.text; el.className = `text-white px-6 py-2 rounded-lg ${btn.class}`; el.onclick = btn.action;
                UI.modalFooter.appendChild(el);
            });
            UI.modal.classList.remove('hidden');
            setTimeout(() => UI.modalContent.classList.remove('scale-95', 'opacity-0'), 10);
        };
        const hideModal = () => {
            UI.modalContent.classList.add('scale-95', 'opacity-0');
            setTimeout(() => UI.modal.classList.add('hidden'), 300);
        };

        const updateNavUI = (user) => {
            const isLoggedIn = !!user;
            UI.authSection.classList.toggle('hidden', isLoggedIn); UI.loggedInContent.classList.toggle('hidden', !isLoggedIn);
            UI.authLinksDesktop.classList.toggle('hidden', isLoggedIn); UI.authLinksMobile.classList.toggle('hidden', isLoggedIn);
            UI.profileDropdownContainer.classList.toggle('hidden', !isLoggedIn); UI.profileInfoMobile.classList.toggle('hidden', !isLoggedIn);
            if (isLoggedIn) UI.userEmailDisplays.forEach(el => el.textContent = user.email);
        };

        onAuthStateChanged(auth, user => {
            updateNavUI(user);
            if (user) { fetchProducts(); fetchUserOrders(user.uid); }
            else { UI.productListDiv.innerHTML = ''; productsData = []; if (unsubscribeOrders) unsubscribeOrders(); }
        });

        const handleBuyNow = (productId) => {
            const product = productsData.find(p => p.id === productId);
            if (!product || !auth.currentUser) return;
            showModal('Confirm Purchase', `Pay <b>$${product.price.toFixed(2)}</b> for <b>${product.name}</b>?<br>This will open your phone dialer.`,
                [{ text: 'Cancel', class: 'bg-gray-500', action: hideModal },
                 { text: 'Proceed', class: 'bg-blue-600', action: async () => {
                    hideModal();
                    try {
                        await addDoc(collection(db, "orders"), {
                            userId: auth.currentUser.uid, userEmail: auth.currentUser.email,
                            productId: product.id, productName: product.name, price: product.price,
                            diamonds: product.diamonds, imageUrl: product.imageUrl,
                            status: "Pending", orderDate: serverTimestamp()
                        });
                        window.location.href = `tel:${encodeURIComponent(`*712*613982172*${product.price}#`)}`;
                    } catch (error) { showModal('Error', 'Could not place order.'); }
                 }}]
            );
        };
        
        const showProductDetails = (productId) => {
            const product = productsData.find(p => p.id === productId); if (!product) return;
            showModal(product.name, `<img src="${product.imageUrl}" class="w-full h-64 object-cover rounded-lg mb-4"><p>${product.description || 'No details available.'}</p>`);
        };

        UI.productListDiv.addEventListener('click', (e) => {
            const card = e.target.closest('.product-card'); if (!card) return;
            if (e.target.classList.contains('buy-now-btn')) handleBuyNow(card.dataset.id); else showProductDetails(card.dataset.id);
        });
        
        UI.searchBar.addEventListener('keyup', () => {
            const term = UI.searchBar.value.toLowerCase();
            document.querySelectorAll('.product-card').forEach(card => card.style.display = card.dataset.name.toLowerCase().includes(term) ? '' : 'none');
        });

        const fetchProducts = async () => {
            productsData = []; UI.productListDiv.innerHTML = `<p class="col-span-full text-center">Loading...</p>`;
            const q = query(collection(db, "products"), orderBy("name")); const snapshot = await getDocs(q);
            UI.productListDiv.innerHTML = '';
            if(snapshot.empty) UI.productListDiv.innerHTML = `<p class="col-span-full text-center">No products found.</p>`;
            else snapshot.forEach(doc => {
                const p = { ...doc.data(), id: doc.id }; productsData.push(p);
                UI.productListDiv.innerHTML += `
                    <div class="product-card bg-white rounded-xl shadow-lg overflow-hidden cursor-pointer" data-id="${p.id}" data-name="${p.name}">
                        <img class="h-64 w-full object-cover pointer-events-none" src="${p.imageUrl}" alt="${p.name}">
                        <div class="p-6 pointer-events-none"><h3 class="text-xl font-semibold">${p.name}</h3><p class="text-sm font-bold text-teal-500 my-2">♦️ ${p.diamonds || 0}</p><p class="text-2xl font-bold mb-4">$${p.price.toFixed(2)}</p></div>
                        <div class="p-4 pt-0"><button data-id="${p.id}" class="buy-now-btn w-full bg-blue-600 text-white py-2 rounded-lg font-semibold">Buy Now</button></div>
                    </div>`;
            });
        };

        const fetchUserOrders = (userId) => {
            if (unsubscribeOrders) unsubscribeOrders();
            const q = query(collection(db, "orders"), where("userId", "==", userId), orderBy("orderDate", "desc"));
            unsubscribeOrders = onSnapshot(q, (snapshot) => {
                UI.orderHistoryList.innerHTML = "";
                if (snapshot.empty) { UI.orderHistoryList.innerHTML = '<tr><td colspan="4" class="p-4 text-center">No orders yet.</td></tr>'; return; }
                snapshot.forEach(doc => {
                    const order = doc.data();
                    const date = order.orderDate ? new Date(order.orderDate.seconds * 1000).toLocaleDateString() : '...';
                    let s = { 'Pending': 'bg-yellow-100 text-yellow-800', 'Completed': 'bg-green-100 text-green-800', 'Rejected': 'bg-red-100 text-red-800' }[order.status] || '';
                    UI.orderHistoryList.innerHTML += `<tr><td class="p-4 font-medium">${order.productName}</td><td class="p-4">${date}</td><td class="p-4">$${order.price.toFixed(2)}</td><td class="p-4"><span class="px-2 py-1 text-xs rounded-full ${s}">${order.status}</span></td></tr>`;
                });
            }, () => UI.orderHistoryList.innerHTML = `<tr><td colspan="4" class="p-4 text-center text-red-500">Error loading orders. A DB index is required.</td></tr>`);
        };

        UI.forgotPasswordLink.addEventListener('click', async () => {
            const email = prompt("Enter email for password reset link:");
            if (email) { try { await sendPasswordResetEmail(auth, email); showModal('Success', 'Password reset link sent.'); } catch (err) { showModal('Error', err.message); }}
        });
        
        UI.loginForm.addEventListener('submit', async e => { e.preventDefault(); try { await signInWithEmailAndPassword(auth, UI.loginForm.email.value, UI.loginForm.password.value); } catch (err) { showModal('Login Failed', err.message); }});
        UI.signupForm.addEventListener('submit', async e => { e.preventDefault(); try { await createUserWithEmailAndPassword(auth, UI.signupForm.email.value, UI.signupForm.password.value); } catch (err) { showModal('Signup Failed', err.message); }});
        
        UI.profileMenuButton.addEventListener('click', () => UI.profileMenu.classList.toggle('hidden'));
        UI.mobileMenuButton.addEventListener('click', () => UI.mobileMenu.classList.toggle('hidden'));
        UI.loginTab.addEventListener('click', () => { UI.signupFormContainer.classList.add('hidden'); UI.loginFormContainer.classList.remove('hidden'); UI.loginTab.classList.add('tab-active'); UI.signupTab.classList.remove('tab-active'); });
        UI.signupTab.addEventListener('click', () => { UI.loginFormContainer.classList.add('hidden'); UI.signupFormContainer.classList.remove('hidden'); UI.signupTab.classList.add('tab-active'); UI.loginTab.classList.remove('tab-active'); });
        
        const handleLogout = () => signOut(auth);
        UI.logoutButtonDesktop.addEventListener('click', handleLogout);
        UI.logoutButtonMobile.addEventListener('click', handleLogout);
        UI.modal.addEventListener('click', (e) => { if(e.target === UI.modal) hideModal(); });

    </script>
</body>
</html>```

### File 2: `admin.html` (No Changes Needed)

Music and the other new features are only for the user's side, so your existing `admin.html` file does not need to be changed. It is already complete.

After updating your `index.html` file on GitHub, your live site will have all the new features, including the user-controlled background music.
